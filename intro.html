<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Introduction - Principles of Mass Spectrometry and Strategies for Data Acquisition – R for Mass Spectrometry</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01-Introduction.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-23d003e80a5415bcd382f8d57091344b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Foundations</a></li><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction - Principles of Mass Spectrometry and Strategies for Data Acquisition</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Mass Spectrometry</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/vanhungtran/RforMS" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction - Principles of Mass Spectrometry and Strategies for Data Acquisition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Mass Spectrometry in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-open-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Accessing Open MS Data with MsDataHub</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Core Techniques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-r-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R Fundamentals for Mass Spectrometry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-data-formats-import-bis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mass Spectrometry Data Formats, Standards, and Import Workflows: A Comprehensive Technical Guide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-spectral-preprocessing-bis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spectral Data Preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-peak-detection-quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Peak Detection and Quantification</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Analysis &amp; Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization for Mass Spectrometry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-statistical-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Statistical Analysis of MS Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-metabolomics-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Metabolomics Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-proteomics-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Proteomics Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-qfeatures-quantitative.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Quantitative Proteomics with QFeatures</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-advanced-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Advanced Topics and Applications</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Summary and Future Directions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ms-data-analysis-workflow" id="toc-ms-data-analysis-workflow" class="nav-link active" data-scroll-target="#ms-data-analysis-workflow"><span class="header-section-number">1.1</span> MS Data Analysis Workflow</a></li>
  <li><a href="#the-fundamental-principle-measuring-molecular-mass" id="toc-the-fundamental-principle-measuring-molecular-mass" class="nav-link" data-scroll-target="#the-fundamental-principle-measuring-molecular-mass"><span class="header-section-number">1.2</span> The Fundamental Principle: Measuring Molecular Mass</a>
  <ul class="collapse">
  <li><a href="#defining-the-analyte-what-is-mass-spectrometry" id="toc-defining-the-analyte-what-is-mass-spectrometry" class="nav-link" data-scroll-target="#defining-the-analyte-what-is-mass-spectrometry"><span class="header-section-number">1.2.1</span> Defining the Analyte: What is Mass Spectrometry?</a></li>
  <li><a href="#the-language-of-mass-spectrometry-understanding-the-mass-to-charge-mz-ratio" id="toc-the-language-of-mass-spectrometry-understanding-the-mass-to-charge-mz-ratio" class="nav-link" data-scroll-target="#the-language-of-mass-spectrometry-understanding-the-mass-to-charge-mz-ratio"><span class="header-section-number">1.2.2</span> The Language of Mass Spectrometry: Understanding the Mass-to-Charge (m/z) Ratio</a></li>
  <li><a href="#anatomy-of-a-mass-spectrometer-a-five-part-journey" id="toc-anatomy-of-a-mass-spectrometer-a-five-part-journey" class="nav-link" data-scroll-target="#anatomy-of-a-mass-spectrometer-a-five-part-journey"><span class="header-section-number">1.2.3</span> Anatomy of a Mass Spectrometer: A Five-Part Journey</a></li>
  </ul></li>
  <li><a href="#the-instrument-hardware-and-ion-physics" id="toc-the-instrument-hardware-and-ion-physics" class="nav-link" data-scroll-target="#the-instrument-hardware-and-ion-physics"><span class="header-section-number">1.3</span> The Instrument: Hardware and Ion Physics</a>
  <ul class="collapse">
  <li><a href="#part-1-sample-introduction-bridging-the-world-to-the-vacuum" id="toc-part-1-sample-introduction-bridging-the-world-to-the-vacuum" class="nav-link" data-scroll-target="#part-1-sample-introduction-bridging-the-world-to-the-vacuum"><span class="header-section-number">1.3.1</span> Part 1: Sample Introduction – Bridging the World to the Vacuum</a></li>
  <li><a href="#part-2-the-ion-source-creating-gas-phase-ions" id="toc-part-2-the-ion-source-creating-gas-phase-ions" class="nav-link" data-scroll-target="#part-2-the-ion-source-creating-gas-phase-ions"><span class="header-section-number">1.3.2</span> Part 2: The Ion Source – Creating Gas-Phase Ions</a></li>
  <li><a href="#part-3-the-mass-analyzer-sorting-ions-by-mz" id="toc-part-3-the-mass-analyzer-sorting-ions-by-mz" class="nav-link" data-scroll-target="#part-3-the-mass-analyzer-sorting-ions-by-mz"><span class="header-section-number">1.3.3</span> Part 3: The Mass Analyzer – Sorting Ions by m/z</a></li>
  <li><a href="#part-4-the-detector-counting-the-ions" id="toc-part-4-the-detector-counting-the-ions" class="nav-link" data-scroll-target="#part-4-the-detector-counting-the-ions"><span class="header-section-number">1.3.4</span> Part 4: The Detector – Counting the Ions</a></li>
  </ul></li>
  <li><a href="#preparing-for-analysis-from-sample-to-instrument" id="toc-preparing-for-analysis-from-sample-to-instrument" class="nav-link" data-scroll-target="#preparing-for-analysis-from-sample-to-instrument"><span class="header-section-number">1.4</span> Preparing for Analysis: From Sample to Instrument</a>
  <ul class="collapse">
  <li><a href="#sample-preparation-the-prerequisite-for-quality-data" id="toc-sample-preparation-the-prerequisite-for-quality-data" class="nav-link" data-scroll-target="#sample-preparation-the-prerequisite-for-quality-data"><span class="header-section-number">1.4.1</span> Sample Preparation: The Prerequisite for Quality Data</a></li>
  <li><a href="#instrument-setup-tuning-and-calibration" id="toc-instrument-setup-tuning-and-calibration" class="nav-link" data-scroll-target="#instrument-setup-tuning-and-calibration"><span class="header-section-number">1.4.2</span> Instrument Setup: Tuning and Calibration</a></li>
  </ul></li>
  <li><a href="#strategies-for-data-collection-designing-the-ms-experiment" id="toc-strategies-for-data-collection-designing-the-ms-experiment" class="nav-link" data-scroll-target="#strategies-for-data-collection-designing-the-ms-experiment"><span class="header-section-number">1.5</span> Strategies for Data Collection: Designing the MS Experiment</a>
  <ul class="collapse">
  <li><a href="#untargeted-acquisition-modes-discovery" id="toc-untargeted-acquisition-modes-discovery" class="nav-link" data-scroll-target="#untargeted-acquisition-modes-discovery"><span class="header-section-number">1.5.1</span> Untargeted Acquisition Modes (Discovery)</a></li>
  <li><a href="#targeted-acquisition-modes-quantification" id="toc-targeted-acquisition-modes-quantification" class="nav-link" data-scroll-target="#targeted-acquisition-modes-quantification"><span class="header-section-number">1.5.2</span> Targeted Acquisition Modes (Quantification)</a></li>
  </ul></li>
  <li><a href="#initial-data-interpretation-understanding-the-output" id="toc-initial-data-interpretation-understanding-the-output" class="nav-link" data-scroll-target="#initial-data-interpretation-understanding-the-output"><span class="header-section-number">1.6</span> Initial Data Interpretation: Understanding the Output</a>
  <ul class="collapse">
  <li><a href="#the-chromatogram-vs.-the-spectrum" id="toc-the-chromatogram-vs.-the-spectrum" class="nav-link" data-scroll-target="#the-chromatogram-vs.-the-spectrum"><span class="header-section-number">1.6.1</span> The Chromatogram vs.&nbsp;The Spectrum</a></li>
  <li><a href="#reading-the-mass-spectrum" id="toc-reading-the-mass-spectrum" class="nav-link" data-scroll-target="#reading-the-mass-spectrum"><span class="header-section-number">1.6.2</span> Reading the Mass Spectrum</a></li>
  </ul></li>
  <li><a href="#a-horizon-of-applications" id="toc-a-horizon-of-applications" class="nav-link" data-scroll-target="#a-horizon-of-applications"><span class="header-section-number">1.7</span> A Horizon of Applications</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/vanhungtran/RforMS/edit/main/intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/vanhungtran/RforMS/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Foundations</a></li><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction - Principles of Mass Spectrometry and Strategies for Data Acquisition</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction - Principles of Mass Spectrometry and Strategies for Data Acquisition</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="ms-data-analysis-workflow" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="ms-data-analysis-workflow"><span class="header-section-number">1.1</span> MS Data Analysis Workflow</h2>
<p>The following diagram illustrates the comprehensive workflow for mass spectrometry data analysis in R:</p>
<div class="cell" data-fig-width="10" data-fig-height="5" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    subgraph Sample["Sample &amp; Instrument"]
        A[Sample Preparation] --&gt; B[Chromatography&lt;br/&gt;LC/GC]
        B --&gt; C[Ionization&lt;br/&gt;ESI/APCI/MALDI]
        C --&gt; D[Mass Analyzer&lt;br/&gt;Orbitrap/TOF/Q]
        D --&gt; E[Detector]
    end
    
    subgraph RawData["Raw Data Files"]
        E --&gt; F[mzML/mzXML Files]
    end
    
    subgraph RPackages["R for Mass Spectrometry"]
        F --&gt; G[Spectra Package&lt;br/&gt;Data Import]
        G --&gt; H{Analysis Type?}
        
        H --&gt;|Proteomics| P1[PSM Matching&lt;br/&gt;PSMatch]
        P1 --&gt; P2[Peptide ID&lt;br/&gt;Protein Inference]
        P2 --&gt; P3[Quantification&lt;br/&gt;QFeatures]
        
        H --&gt;|Metabolomics| M1[Peak Detection&lt;br/&gt;xcms]
        M1 --&gt; M2[Retention Time&lt;br/&gt;Correction]
        M2 --&gt; M3[Feature Matching&lt;br/&gt;CAMERA]
        
        H --&gt;|Spectral Processing| S1[Preprocessing&lt;br/&gt;MsCoreUtils]
        S1 --&gt; S2[Peak Picking]
        S2 --&gt; S3[Baseline Correction]
    end
    
    subgraph Analysis["Statistical Analysis"]
        P3 --&gt; SA[Feature Matrix]
        M3 --&gt; SA
        S3 --&gt; SA
        SA --&gt; SB[Quality Control&lt;br/&gt;Missing Values]
        SB --&gt; SC[Normalization]
        SC --&gt; SD[Statistical Tests&lt;br/&gt;limma/DEqMS]
    end
    
    subgraph Viz["Visualization &amp; Results"]
        SD --&gt; V1[PCA/Clustering&lt;br/&gt;factoextra]
        SD --&gt; V2[Volcano Plots&lt;br/&gt;ggplot2]
        SD --&gt; V3[Heatmaps&lt;br/&gt;pheatmap]
        V1 --&gt; OUT[Biological&lt;br/&gt;Interpretation]
        V2 --&gt; OUT
        V3 --&gt; OUT
    end
    
    style Sample fill:#D7E6FB,stroke:#27408B,stroke-width:3px,color:#102A43
    style RawData fill:#FBE0FA,stroke:#B000B0,stroke-width:3px,color:#102A43
    style RPackages fill:#D7E6FB,stroke:#27408B,stroke-width:3px,color:#102A43
    style Analysis fill:#FBE0FA,stroke:#B000B0,stroke-width:3px,color:#102A43
    style Viz fill:#D7E6FB,stroke:#27408B,stroke-width:3px,color:#102A43
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Workflow Components
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Sample &amp; Instrument</strong>: Physical sample preparation through mass analyzer detection</li>
<li><strong>Raw Data</strong>: Standard MS data formats (mzML, mzXML, MGF)</li>
<li><strong>R Packages</strong>: Modular ecosystem for specific analysis types</li>
<li><strong>Statistical Analysis</strong>: QC, normalization, and hypothesis testing</li>
<li><strong>Visualization</strong>: Comprehensive plotting for interpretation</li>
</ul>
</div>
</div>
</section>
<section id="the-fundamental-principle-measuring-molecular-mass" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="the-fundamental-principle-measuring-molecular-mass"><span class="header-section-number">1.2</span> The Fundamental Principle: Measuring Molecular Mass</h2>
<p>Mass spectrometry (MS) is a foundational technique for analyzing the mass-to-charge (<span class="math inline">m/z</span>) ratio of ions, enabling <strong>precise identification and quantification</strong> of both small molecules and biomolecules.[7, 15, 11] The core process converts neutral analytes into gas-phase ions that can be manipulated by electromagnetic fields, providing a quantitative bridge between molecular structure and measured signal.</p>
<ul>
<li><strong>Key Applications:</strong>
<ul>
<li>Identification of unknown compounds</li>
<li>Quantification of target analytes</li>
<li>Structural elucidation through fragmentation analysis</li>
</ul></li>
</ul>
<p><em>Reference:</em> de Hoffmann &amp; Stroobant, <em>Mass Spectrometry: Principles and Applications</em>, 3rd Ed. (Wiley, 2007).[7, 15]</p>
<p>The sections that follow expand this high-level view with practical considerations for instrumentation, sample handling, and data acquisition.</p>
<section id="defining-the-analyte-what-is-mass-spectrometry" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="defining-the-analyte-what-is-mass-spectrometry"><span class="header-section-number">1.2.1</span> Defining the Analyte: What is Mass Spectrometry?</h3>
<p>Mass spectrometry (MS) is a powerful analytical technology used to measure the mass-to-charge ratio (<span class="math inline">m/z</span>) of ions.[1, 2] This fundamental measurement, taken from a sample, allows for the precise calculation of the molecular weights of the constituent components.[1, 3]</p>
<p>From this single, core capability, the primary applications of the technique are derived. Mass spectrometry is used to identify unknown compounds, to quantify known compounds, and to elucidate the chemical structure of molecules.[1, 2]</p>
<p>The defining principle of mass spectrometry is not “weighing” neutral molecules, but rather <em>manipulating</em> them. A neutral molecule is effectively invisible to the instrument. The entire process is contingent upon the successful conversion of a neutral analyte molecule, which may be in a solid, liquid, or gaseous state, into a gas-phase <em>ion</em>.[2, 4] It is only because ions possess a charge that they can be moved, accelerated, focused, and manipulated by external electric and magnetic fields.[1, 4, 5] Thus, “mass spectrometry” is, perhaps more accurately, “ion spectrometry.”</p>
</section>
<section id="the-language-of-mass-spectrometry-understanding-the-mass-to-charge-mz-ratio" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="the-language-of-mass-spectrometry-understanding-the-mass-to-charge-mz-ratio"><span class="header-section-number">1.2.2</span> The Language of Mass Spectrometry: Understanding the Mass-to-Charge (m/z) Ratio</h3>
<p>The primary output of a mass spectrometer is the <strong>mass spectrum</strong>. This is a plot, or histogram, showing the relative abundance or signal intensity of detected ions (y-axis) as a function of their mass-to-charge ratio, or <span class="math inline">m/z</span> (x-axis).[3, 6, 7]</p>
<p>The <span class="math inline">m/z</span> value is a dimensionless quantity, formally defined by IUPAC as the mass of an ion (in Daltons, Da) divided by its charge number (<span class="math inline">z</span>).[8] A common misconception, particularly for new users, is to equate the x-axis with “mass.” This is only true in cases where the charge number, <span class="math inline">z</span>, is equal to 1.[6] While this is common for many ionization techniques (such as Electron Ionization or Matrix-Assisted Laser Desorption/Ionization), it is a critical error when interpreting data from other methods.</p>
<p>Soft ionization techniques like Electrospray Ionization (ESI) are defined by their ability to create <em>multiply-charged ions</em>, such as <span class="math inline">[M + nH]^{n+}</span>.[9, 10] A mass analyzer <em>always</em> measures the <span class="math inline">m/z</span> ratio. For example, a 40,000 Da protein that has acquired 20 charges (a charge state of +20) will not appear at 40,000 on the x-axis; it will be detected at an <span class="math inline">m/z</span> value of approximately 2,000. Understanding that <span class="math inline">m/z</span> is the <em>measured</em> quantity and <em>mass</em> is the <em>inferred</em> property is the single most critical concept for interpreting spectra from modern soft ionization sources.</p>
</section>
<section id="anatomy-of-a-mass-spectrometer-a-five-part-journey" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="anatomy-of-a-mass-spectrometer-a-five-part-journey"><span class="header-section-number">1.2.3</span> Anatomy of a Mass Spectrometer: A Five-Part Journey</h3>
<p>While often simplified to three essential functions—ionization, sorting, and detection [1, 2, 4, 5]—a functional mass spectrometer relies on five distinct systems working in concert. The journey of an analyte from a sample vial to a data point involves:</p>
<ol type="1">
<li><strong>The Sample Inlet:</strong> Introduces the sample to the instrument.</li>
<li><strong>The Ion Source:</strong> Converts neutral analyte molecules into gas-phase ions.</li>
<li><strong>The Mass Analyzer:</strong> Sorts the ions based on their <span class="math inline">m/z</span> ratio.</li>
<li><strong>The Detector:</strong> Measures the abundance of the sorted ions.</li>
<li><strong>The Vacuum System:</strong> Maintains a low-pressure environment for ion manipulation.</li>
</ol>
<p>A central engineering challenge defines the architecture of all modern mass spectrometers: the atmospheric-vacuum conflict. A mass spectrometer must operate under a high vacuum (typically <span class="math inline">10^{-5}</span> to <span class="math inline">10^{-8}</span> torr).[4, 11, 12] This is a non-negotiable requirement. Ions are highly reactive and short-lived, and their “flight” path from the source to the detector must be free of collision with air molecules, which would otherwise scatter them or neutralize them.[4, 5]</p>
<p>Our samples, however, exist at atmospheric pressure (760 torr).[4, 11] The core engineering marvel of modern MS, particularly when coupled with Liquid Chromatography (LC-MS), is the <em>interface</em> that bridges these two hostile worlds. The function of the inlet and ion source is not just to ionize, but to do so while successfully and efficiently transitioning the analyte from 760 torr to <span class="math inline">10^{-8}</span> torr—a pressure drop of over 100 million-fold.[13, 14]</p>
</section>
</section>
<section id="the-instrument-hardware-and-ion-physics" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="the-instrument-hardware-and-ion-physics"><span class="header-section-number">1.3</span> The Instrument: Hardware and Ion Physics</h2>
<p>Modern mass spectrometers integrate five principal systems that must operate in concert to deliver reliable data: the sample inlet, ion source, mass analyzer, detector, and vacuum infrastructure.[7] Each subsystem introduces specialized trade-offs—balancing robustness, sensitivity, resolution, and throughput—that dictate the suitability of an instrument for a particular application.</p>
<ul>
<li><strong>Sample Inlet:</strong> Transfers material from atmospheric pressure into the instrument without overwhelming the vacuum system.[7]</li>
<li><strong>Ion Source:</strong> Converts neutral molecules to charged ions via hard (EI) or soft (ESI, APCI, MALDI) mechanisms.[8, 11]</li>
<li><strong>Mass Analyzer:</strong> Separates ions by <span class="math inline">m/z</span>, with quadrupole, TOF, and Orbitrap analyzers offering distinct combinations of resolution, scan speed, and mass range.[7, 9]</li>
<li><strong>Detector:</strong> Electron multipliers and Faraday cups transduce ion impacts into measurable electrical signals.[19]</li>
<li><strong>Vacuum System:</strong> Maintains the mean-free path necessary to prevent ion-neutral collisions that would degrade sensitivity.[19]</li>
</ul>
<p><strong>Modern innovations</strong>—including high-field Orbitraps and hybrid Q-TOF or Q-Orbitrap designs—provide ultra-high resolution and accurate mass performance that underpin contemporary systems biology and omics research workflows.[9, 7, 15]</p>
<section id="part-1-sample-introduction-bridging-the-world-to-the-vacuum" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="part-1-sample-introduction-bridging-the-world-to-the-vacuum"><span class="header-section-number">1.3.1</span> Part 1: Sample Introduction – Bridging the World to the Vacuum</h3>
<p>The inlet’s function is to introduce a small amount of the sample into the ion source with minimal disruption of the high vacuum.[13, 14] The choice of inlet represents the first major analytical decision, one that separates the analysis of pure or simple substances from that of complex mixtures.[12, 15, 16, 17]</p>
<section id="direct-infusion-and-direct-probes" class="level4">
<h4 class="anchored" data-anchor-id="direct-infusion-and-direct-probes">Direct Infusion and Direct Probes</h4>
<p>For pure or simple, pre-purified samples, the inlet can be very simple. * <strong>Direct Infusion:</strong> The sample is dissolved in a solvent, placed in a syringe, and infused at a slow, continuous flow rate (e.g., 1-10 µL/min) directly into the ion source.[17] This is fast, simple, and provides an aggregate “snapshot” of the sample’s components without any prior separation. * <strong>Direct Probes:</strong> For non-volatile solids or liquids, the sample can be placed on the tip of a probe, which is then inserted through a vacuum lock directly into the ion source.[4, 12]</p>
</section>
<section id="hyphenated-techniques-gc-ms-and-lc-ms" class="level4">
<h4 class="anchored" data-anchor-id="hyphenated-techniques-gc-ms-and-lc-ms">Hyphenated Techniques (GC-MS and LC-MS)</h4>
<p>For complex mixtures (e.g., blood plasma, environmental water, proteomic digests), direct infusion would result in a single, hopelessly complex mass spectrum. The solution is to “hyphenate” (couple) a chromatographic separation system to the mass spectrometer.[14, 15, 16] The gas chromatograph (GC) or liquid chromatograph (LC) acts as the inlet, providing a time-based separation of the mixture. The MS then acts as a highly sensitive and specific detector, analyzing the compounds as they elute from the column one by one.[16, 18] This adds a second dimension of data (retention time) to the analysis.</p>
</section>
<section id="the-gc-ms-interface" class="level4">
<h4 class="anchored" data-anchor-id="the-gc-ms-interface">The GC-MS Interface</h4>
<p>This interface is relatively simple. A sample is injected into a hot GC inlet, where it is <em>vaporized</em>.[18, 19] An inert carrier gas (e.g., helium) carries the gaseous analytes through the GC column, where they are separated. The gas eluent from the column flows via a heated transfer line [19] directly into the ion source, which is located <em>inside</em> the high-vacuum chamber. The high-capacity turbomolecular pumps of the MS can easily handle the low gas flow (typically 1-2 mL/min) from the GC column, maintaining the high vacuum.[20]</p>
</section>
<section id="the-lc-ms-interface-and-atmospheric-pressure-ionization-api" class="level4">
<h4 class="anchored" data-anchor-id="the-lc-ms-interface-and-atmospheric-pressure-ionization-api">The LC-MS Interface and Atmospheric Pressure Ionization (API)</h4>
<p>This interface is far more complex. LC uses a <em>liquid</em> mobile phase, often at flow rates of 0.2 to 1.0 mL/min.[21, 22] Injecting this volume of liquid directly into a <span class="math inline">10^{-8}</span> torr vacuum would instantly vaporize it, overwhelming the pumps and destroying the vacuum.</p>
<p>This problem was solved by the invention of <strong>Atmospheric Pressure Ionization (API)</strong>.[21, 23, 24] Instead of attempting to force the liquid into the vacuum, ionization (e.g., ESI or APCI) occurs <em>at atmospheric pressure</em> (760 torr), <em>outside</em> the mass spectrometer’s vacuum chamber. The resulting cloud of gas-phase ions is then “sampled” into the instrument through a series of “skimmers” and “cones.” These are small orifices and ion lenses that separate chambers of progressively higher vacuum (e.g., 1 torr -&gt; <span class="math inline">10^{-3}</span> torr -&gt; <span class="math inline">10^{-8}</span> torr), each powered by its own set of pumps.[21, 25] This multi-stage pressure differential efficiently pulls the ions into the mass analyzer while pumping away the vast majority of neutral gas and solvent molecules. This API interface is the key technology that enables all modern LC-MS.</p>
</section>
</section>
<section id="part-2-the-ion-source-creating-gas-phase-ions" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="part-2-the-ion-source-creating-gas-phase-ions"><span class="header-section-number">1.3.2</span> Part 2: The Ion Source – Creating Gas-Phase Ions</h3>
<p>The choice of ion source is the next critical experimental decision, as it dictates the type of data that will be obtained. Sources are broadly classified into two paradigms: “hard” and “soft” ionization.[26, 27, 28]</p>
<ul>
<li><strong>Hard Ionization:</strong> These techniques, such as Electron Ionization (EI), use a high amount of energy. This not only ionizes the molecule but also causes extensive and reproducible fragmentation. This fragmentation provides a rich “fingerprint” used for structural identification, but it may also be so energetic that the original, intact molecular ion is destroyed and not observed.[28, 29, 30, 31]</li>
<li><strong>Soft Ionization:</strong> These techniques, such as ESI, APCI, and MALDI, use a much gentler energy input. Their goal is to preserve the intact molecule, transferring just enough energy to create an ion (e.g., by adding a proton, <span class="math inline">[M+H]^{+}</span>). This provides a clear, unambiguous signal for the molecular ion, allowing for easy determination of molecular weight, but it provides minimal fragmentation.[26, 29, 32]</li>
</ul>
<section id="hard-ionization-electron-ionization-ei" class="level4">
<h4 class="anchored" data-anchor-id="hard-ionization-electron-ionization-ei">Hard Ionization: Electron Ionization (EI)</h4>
<ul>
<li><strong>Principle:</strong> EI is the classic ionization method and is used almost exclusively with GC-MS for volatile or semi-volatile compounds.[29, 33]</li>
<li><strong>Mechanism:</strong> Inside the high-vacuum source, a filament (tungsten or rhenium) is heated to emit a steady stream of electrons. These electrons are accelerated by a voltage potential, creating a beam of high-energy electrons, standardized across all instruments at <strong>70 electron volts (eV)</strong>.[28, 34] As the neutral, gaseous analyte (M) from the GC passes through this beam, an electron collision ejects one of the analyte’s own electrons, creating a <em>radical cation</em> (<span class="math inline">M^{+\bullet}</span>).[28, 34, 35]</li>
<li><strong>Fragmentation:</strong> The 70 eV of energy is far more than is needed for ionization (typically ~10 eV).[34] The excess energy is deposited into the newly formed <span class="math inline">M^{+\bullet}</span>, causing its bonds to shatter in a predictable, reproducible way.[29, 30] This <em>fragmentation pattern</em> is a unique “fingerprint” for that molecule’s structure.[28] This reproducibility allows the acquired spectrum to be matched against vast spectral libraries (e.g., NIST, Wiley) for positive compound identification.[29, 34]</li>
<li><strong>Limitations:</strong> The analyte <em>must</em> be volatile and thermally stable enough to be in the gas phase.[28, 35] It is generally limited to compounds below 600-1000 Da [35, 36], and the molecular ion is often weak or entirely absent.[30, 37]</li>
</ul>
</section>
<section id="soft-ionization-api-electrospray-ionization-esi" class="level4">
<h4 class="anchored" data-anchor-id="soft-ionization-api-electrospray-ionization-esi">Soft Ionization (API): Electrospray Ionization (ESI)</h4>
<ul>
<li><strong>Principle:</strong> ESI is the most common and important LC-MS source.[33] It is ideal for analyzing polar, ionizable, and large biomolecules that are dissolved in a liquid mobile phase.</li>
<li><strong>Mechanism:</strong> ESI is a liquid-phase ionization mechanism.[24] The liquid eluent from the LC (e.g., water and acetonitrile) is pumped through a fused-silica or stainless steel capillary. A high voltage (typically 4-5 kV) is applied to this capillary, creating a strong electric field at the tip.[9, 38, 39] This field forces the liquid to emerge as a fine “electrospray” of highly charged droplets.[29, 32] A counter-current of heated drying gas (e.g., nitrogen) and a heated capillary tube cause the solvent in the droplets to evaporate.[32] As the droplets shrink, the charge density on their surface increases. This continues until the “Rayleigh limit” is breached—the point at which the coulombic repulsion of the charges overcomes the droplet’s surface tension.[9] At this point, the droplet explodes, or, more commonly, ejects a stream of gas-phase ions that are then sampled into the mass spectrometer.[39]</li>
<li><strong>Multiple Charging:</strong> ESI’s defining characteristic and “superpower” is its ability to generate <em>multiply-charged ions</em>.[9, 10] For example, a large protein with many basic sites (like lysine and arginine) will acquire many protons, resulting in a series of ions like <span class="math inline">[M+10H]^{10+}</span>, <span class="math inline">[M+11H]^{11+}</span>, <span class="math inline">[M+12H]^{12+}</span>, etc. This is a revolutionary advantage. A 50,000 Da protein with 50 positive charges (<span class="math inline">[M+50H]^{50+}</span>) will have an <span class="math inline">m/z</span> value of (50,000 + 50) / 50 ≈ 1001. This “cheat code” allows massive molecules—proteins, oligonucleotides, and polymers—to be analyzed by mass analyzers with a limited <span class="math inline">m/z</span> range (e.g., a quadrupole that tops out at <span class="math inline">m/z</span> 4000). This capability single-handedly enabled the field of proteomics and the analysis of large biomolecules.[32, 40]</li>
</ul>
</section>
<section id="soft-ionization-api-atmospheric-pressure-chemical-ionization-apci" class="level4">
<h4 class="anchored" data-anchor-id="soft-ionization-api-atmospheric-pressure-chemical-ionization-apci">Soft Ionization (API): Atmospheric Pressure Chemical Ionization (APCI)</h4>
<ul>
<li><strong>Principle:</strong> APCI is a complementary LC-MS source, used for analytes that ESI struggles to ionize: namely, <em>less polar, neutral, or non-polar</em> small molecules.[29, 41, 42]</li>
<li><strong>Mechanism:</strong> Unlike ESI, APCI is a <em>gas-phase</em> ionization mechanism.[24] The LC eluent first passes through a high-temperature nebulizer (a “vaporizer”), which converts the liquid stream into a hot aerosol of neutral analyte and solvent molecules.[23, 43] This aerosol then passes a <em>corona discharge needle</em>, which maintains a high voltage.[23, 24] This voltage is high enough to ionize the <em>solvent</em> and <em>drying gas</em> (e.g., <span class="math inline">N_2 + e^- \rightarrow N_2^{+\bullet}</span>). These ionized solvent molecules (now a reagent gas) collide with the neutral analyte molecules (M) and ionize them via simple chemical reactions, most commonly proton transfer (e.g., <span class="math inline">^+ + M \rightarrow Solvent + [M+H]^+</span>).[22, 29]</li>
<li><strong>ESI vs.&nbsp;APCI Complementarity:</strong> ESI and APCI are not competitors; they are a complementary pair that together can analyze a vast range of compounds.[10, 26, 33] The operator chooses based on the analyte’s properties:
<ul>
<li><strong>Use ESI for:</strong> Polar, ionizable, thermally <em>labile</em> (cannot be heated), and large molecules (peptides, proteins, polar metabolites).[9, 32]</li>
<li><strong>Use APCI for:</strong> Less-polar, neutral, thermally <em>stable</em> (must survive vaporization) small molecules (steroids, lipids, pesticides, pharmaceuticals).[24, 41, 42]</li>
</ul></li>
</ul>
</section>
<section id="soft-ionization-vacuum-matrix-assisted-laser-desorptionionization-maldi" class="level4">
<h4 class="anchored" data-anchor-id="soft-ionization-vacuum-matrix-assisted-laser-desorptionionization-maldi">Soft Ionization (Vacuum): Matrix-Assisted Laser Desorption/Ionization (MALDI)</h4>
<ul>
<li><strong>Principle:</strong> MALDI is a solid-state, pulsed technique, distinct from the continuous-flow ESI and APCI.</li>
<li><strong>Mechanism:</strong> The analyte is first mixed with a “matrix”—a small, organic, highly UV-absorbing compound (like sinapinic acid or 2,5-DHB).[29, 44] A droplet of this mixture is applied to a metal target plate and allowed to dry. The analyte and matrix co-crystallize.[45, 46] The plate is inserted into the MS vacuum. A pulsed laser (e.g., a nitrogen laser at 337 nm) [45, 46] is fired at the crystal spot. The <em>matrix</em> is chosen to “sacrificially” absorb this high-energy pulse, <em>not</em> the analyte.[29, 44, 47] This causes a “plume” of desorption and ablation, energetically carrying the intact, neutral analyte into the gas phase. In this hot, dense plume, proton transfer occurs from the ionized matrix molecules to the analyte, creating ions.[45]</li>
<li><strong>Characteristics:</strong> MALDI almost exclusively produces <em>singly-charged ions</em> (<span class="math inline">[M+H]^{+}</span>), even for very large molecules.[9, 26, 33] This makes its spectra very simple to interpret, as the <span class="math inline">m/z</span> value is a direct measurement of the molecule’s mass (plus a proton).</li>
<li><strong>MALDI-TOF “Perfect Match”:</strong> MALDI is a <em>pulsed</em> technique (the laser fires in discrete shots).[33, 45] A Time-of-Flight (TOF) mass analyzer (see 2.3.2) is also a <em>pulsed</em> technique (it analyzes ions in “packets”). This makes them an ideal and ubiquitous instrumental pairing (MALDI-TOF).[33, 48, 49]</li>
<li><strong>Application Highlight: MALDI Imaging (MSI):</strong> Because the laser can be precisely aimed, an operator can fire the laser in a rastering grid pattern (e.g., 50 µm x 50 µm) across an entire biological tissue section.[50] By acquiring a full mass spectrum at each x,y coordinate, the instrument can generate a <em>label-free</em> map showing the spatial distribution of <em>any</em> molecule (drugs, lipids, proteins) within the tissue.[26, 50, 51, 52, 53] This creates a “molecular picture,” or “molecular histology,” a powerful tool in pathology and pharmaceutical research.[53, 54]</li>
</ul>
<p><br> <strong>Table 1. Comparison of Common Ionization Techniques</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Technique</th>
<th style="text-align: left;">Principle</th>
<th style="text-align: left;">Ionization Phase</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Typical Analytes</th>
<th style="text-align: left;">Key Features &amp; Common MS Pairing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Electron Ionization (EI)</strong></td>
<td style="text-align: left;">High-energy electron bombardment (70 eV)</td>
<td style="text-align: left;">Gas-Phase (High Vacuum)</td>
<td style="text-align: left;">Hard</td>
<td style="text-align: left;">Volatile/Semi-volatile small molecules (&lt;1000 Da)</td>
<td style="text-align: left;">Extensive fragmentation (fingerprint); Molecular ion often absent. <strong>(GC-MS)</strong> [28, 29, 35]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Electrospray Ionization (ESI)</strong></td>
<td style="text-align: left;">High-voltage electrospray of a liquid; solvent evaporation</td>
<td style="text-align: left;">Liquid-Phase (Atmospheric)</td>
<td style="text-align: left;">Soft</td>
<td style="text-align: left;">Polar, ionizable, large molecules (peptides, proteins, metabolites)</td>
<td style="text-align: left;"><strong>Multiple charging</strong> (<span class="math inline">[M+nH]^{n+}</span>) is its key feature; analyzes massive molecules. <strong>(LC-MS)</strong> [9, 10, 38]</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Atmospheric Pressure Chemical Ionization (APCI)</strong></td>
<td style="text-align: left;">Corona discharge ionizes solvent, which transfers charge to analyte</td>
<td style="text-align: left;">Gas-Phase (Atmospheric)</td>
<td style="text-align: left;">Soft</td>
<td style="text-align: left;">Less-polar, neutral, thermally stable small molecules</td>
<td style="text-align: left;">Requires analyte to be stable to vaporization; complements ESI. <strong>(LC-MS)</strong> [24, 29, 41, 43]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Matrix-Assisted Laser Desorption/Ionization (MALDI)</strong></td>
<td style="text-align: left;">Pulsed laser desorbs analyte and UV-absorbing matrix; proton transfer in plume</td>
<td style="text-align: left;">Solid-State (Vacuum)</td>
<td style="text-align: left;">Soft</td>
<td style="text-align: left;">Very large molecules (proteins, polymers, oligonucleotides)</td>
<td style="text-align: left;">Produces <strong>singly-charged ions</strong> (<span class="math inline">[M+H]^+</span>); pulsed technique. <strong>(MALDI-TOF)</strong> [9, 26, 45]</td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
</section>
<section id="part-3-the-mass-analyzer-sorting-ions-by-mz" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="part-3-the-mass-analyzer-sorting-ions-by-mz"><span class="header-section-number">1.3.3</span> Part 3: The Mass Analyzer – Sorting Ions by m/z</h3>
<p>The mass analyzer is the “heart” of the instrument.[4] It receives the continuous or pulsed stream of ions from the ion source and sorts them based on their <span class="math inline">m/z</span> ratio.[1, 5] No single analyzer is “best.” A fundamental trade-off, an “iron triangle,” exists between three key performance metrics: <strong>Resolution</strong> (the ability to distinguish between two ions of very similar <span class="math inline">m/z</span>), <strong>Scan Speed</strong> (how fast a full spectrum can be acquired), and <strong>Mass Range/Cost</strong>. The operator’s analytical goal dictates the correct tool.</p>
<section id="the-workhorse-quadrupole-mass-filters" class="level4">
<h4 class="anchored" data-anchor-id="the-workhorse-quadrupole-mass-filters">The Workhorse: Quadrupole Mass Filters</h4>
<ul>
<li><strong>Principle:</strong> A quadrupole consists of four parallel metal rods, precisely aligned.[55, 56]</li>
<li><strong>Mechanism:</strong> A combination of an oscillating radio frequency (RF) voltage and a static DC voltage is applied to the rods.[55, 57] This creates a complex, oscillating electric field in the space between the rods. For a <em>given</em> RF/DC voltage ratio, only ions of a <em>single, specific</em> <span class="math inline">m/z</span> value have a <em>stable trajectory</em> through the field and can pass through to the detector.[55, 56] All other ions—those with a slightly higher or lower <span class="math inline">m/z</span>—have an “unstable” trajectory. Their oscillations grow exponentially until they collide with one of the rods and are neutralized.[58] It is, therefore, a “mass filter,” not a scanner.</li>
<li><strong>Operation:</strong> To acquire a full spectrum, the instrument does not scan in a single measurement. Instead, it rapidly sweeps the RF/DC voltages from low to high. This action allows <span class="math inline">m/z</span> 100 to pass, then <span class="math inline">m/z</span> 101, then <span class="math inline">m/z</span> 102, etc., sequentially filtering each mass to the detector to build the spectrum over time.[58, 59] Quadrupoles are relatively inexpensive, robust, and fast, but are low-resolution analyzers.[48, 55]</li>
</ul>
</section>
<section id="the-speed-demon-time-of-flight-tof-analyzers" class="level4">
<h4 class="anchored" data-anchor-id="the-speed-demon-time-of-flight-tof-analyzers">The Speed Demon: Time-of-Flight (TOF) Analyzers</h4>
<ul>
<li><strong>Principle:</strong> A TOF analyzer is an ion “race”.[11] The analyzer itself is a long (1-2 meter) “drift tube” or “flight tube,” which is kept at a high vacuum and is, crucially, <em>free</em> of any electric or magnetic fields.[60, 61, 62]</li>
<li><strong>Mechanism:</strong> A “packet” of ions from the source is accelerated by a single, strong electric pulse. This pulse gives <em>all</em> ions, regardless of their mass, the <em>same kinetic energy (KE)</em>.[3, 62, 63]</li>
<li><strong>The KE =</strong> <span class="math inline">\frac{1}{2}mv^2</span> Logic: This is the core principle. Since all ions have the same kinetic energy (<span class="math inline">KE</span>), an ion’s velocity (<span class="math inline">v</span>) must be <em>inversely</em> proportional to the square root of its mass (<span class="math inline">m</span>).[62, 64] Therefore, <em>lighter</em> ions (<span class="math inline">low m/z</span>) fly <em>faster</em>, and <em>heavier</em> ions (<span class="math inline">high m/z</span>) fly <em>slower</em>.[3, 63, 65]</li>
<li><strong>Operation:</strong> The detector, at the end of the flight tube, measures the <em>time of flight</em> for each ion to travel the known distance.[60] This flight time is easily converted to an <span class="math inline">m/z</span> value. Because it measures all ions from a single pulse “at once” (rather than scanning sequentially like a quadrupole), it is extremely fast and sensitive.[48]</li>
<li><strong>Key Feature: The Reflectron:</strong> A simple “linear” TOF has poor resolution because not all ions start at the exact same place or get the exact same KE.[65] All modern TOF instruments use a <strong>reflectron</strong>, or “ion mirror.” This is an electrostatic field at the end of the tube that repels the ions and sends them back (often at a slight angle) toward the detector.[65] Ions with slightly more KE penetrate <em>deeper</em> into this mirror, taking a <em>longer</em> path. Ions with less KE penetrate less, taking a <em>shorter</em> path. This “time-of-flight focusing” [60] ensures that all ions of the <em>same</em> <span class="math inline">m/z</span> (despite small energy differences) hit the detector at the <em>exact same time</em>, dramatically increasing the instrument’s resolution.[60, 65]</li>
</ul>
</section>
<section id="the-high-resolution-master-the-orbitrap" class="level4">
<h4 class="anchored" data-anchor-id="the-high-resolution-master-the-orbitrap">The High-Resolution Master: The Orbitrap</h4>
<ul>
<li><strong>Principle:</strong> The Orbitrap is the newest major mass analyzer.[66] It is an <em>ion trap</em> that uses only <em>electrostatic</em> fields (no magnets).[67] It consists of a central, spindle-shaped electrode fitted inside a split, barrel-shaped outer electrode.[55, 67]</li>
<li><strong>Mechanism:</strong> Ions are injected tangentially into the trap. The electric field causes them to be “trapped” in a stable orbit around the central spindle.[68] As they orbit, they also oscillate back and forth along the axis of the spindle (axial oscillation).[55, 67]</li>
<li><strong>Operation:</strong> The <em>frequency</em> (<span class="math inline">\omega</span>) of this axial oscillation is <em>independent</em> of the ion’s energy and is related <em>only</em> to its mass-to-charge ratio (<span class="math inline">\omega \propto 1/\sqrt{m/z}</span>).[67] The oscillating packets of ions induce a tiny “image current” in the two halves of the outer electrode.[68, 69] This complex signal, called a “transient,” is a superposition of all the different frequencies from all the different ion packets trapped in the cell.</li>
<li><strong>Data Processing:</strong> A mathematical operation, the <strong>Fourier Transform (FT)</strong>, is used to deconvolute this complex time-domain transient signal into its component frequencies.[67, 69, 70] These frequencies are then converted into the final, high-resolution <span class="math inline">m/z</span> spectrum.</li>
<li><strong>Characteristics:</strong> The Orbitrap is the definition of <strong>HRAM (High-Resolution Accurate-Mass)</strong>.[68, 71, 72] Resolution is routinely set between 60,000 and 500,000 FWHM (Full Width at Half Maximum) [68, 73], with mass accuracy better than 1 part-per-million (ppm).[67] This is so precise that it can often determine a molecule’s <em>elemental formula</em> (e.g., distinguish <span class="math inline">C_{10}H_{12}O</span> from <span class="math inline">C_9H_8O_2</span>) from the accurate mass alone.[74]</li>
</ul>
</section>
<section id="hybrid-and-tandem-instruments-msms" class="level4">
<h4 class="anchored" data-anchor-id="hybrid-and-tandem-instruments-msms">Hybrid and Tandem Instruments (MS/MS)</h4>
<p>The true power of modern mass spectrometry comes from <em>combining</em> these analyzers in sequence, a technique known as <strong>Tandem Mass Spectrometry (MS/MS or</strong> <span class="math inline">MS^n</span>).[16, 55, 75, 76] This allows for complex experimental designs for structural elucidation and quantification.</p>
<ul>
<li><strong>Mechanism (Tandem-in-Space):</strong>
<ol type="1">
<li><strong>MS1 (Analyzer 1):</strong> Selects an ion of interest (the “precursor ion”) and filters away all others.</li>
<li><strong>Collision Cell (q2):</strong> The selected precursor ion is passed into a cell (often a quadrupole or other ion guide) filled with a low pressure of an inert gas like argon or nitrogen. The ion collides with the gas, gains internal energy, and fragments. This is called <strong>Collision-Induced Dissociation (CID)</strong>.[70, 75, 76]</li>
<li><strong>MS2 (Analyzer 2):</strong> The resulting “product ions” (the fragments) are passed to a second mass analyzer, which scans and detects them.</li>
</ol></li>
<li><strong>Common Hybrids:</strong>
<ul>
<li><strong>Triple Quadrupole (QqQ):</strong> Q1 (MS1, filter) <span class="math inline">\rightarrow</span> q2 (collision cell) <span class="math inline">\rightarrow</span> Q3 (MS2, filter). This is the gold standard instrument for targeted quantification.[71, 77, 78]</li>
<li><strong>Quadrupole-Time-of-Flight (Q-TOF):</strong> Q1 (MS1, filter) <span class="math inline">\rightarrow</span> q2 (collision cell) <span class="math inline">\to</span> TOF (MS2, high-resolution scanner). A workhorse for discovery proteomics and metabolomics, combining a filter with a fast, high-resolution analyzer.[60, 75, 79]</li>
<li><strong>Quadrupole-Orbitrap (e.g., Q-Exactive):</strong> Q1 (MS1, filter) <span class="math inline">\rightarrow</span> Collision Cell <span class="math inline">\rightarrow</span> Orbitrap (MS2, HRAM scanner). The premier HRAM discovery instrument, offering high-resolution analysis of product ions.[66, 70, 72]</li>
</ul></li>
<li><strong>Mechanism (Tandem-in-Time):</strong> Some traps, like an Orbitrap or Ion Trap, can perform MS/MS <em>in time</em> instead of <em>in space</em>. They trap all ions, electrostatically eject all <em>but</em> the precursor of interest, fragment that ion <em>inside the trap</em> using CID, and then analyze the resulting product ions in the same device.[76, 80]</li>
</ul>
<p><br> <strong>Table 2. Comparison of Primary Mass Analyzers</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Analyzer</th>
<th style="text-align: left;">Principle of Separation</th>
<th style="text-align: left;">Typical Resolution</th>
<th style="text-align: left;">Mass Accuracy</th>
<th style="text-align: left;">Scan Speed</th>
<th style="text-align: left;">Key Application</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Quadrupole</strong></td>
<td style="text-align: left;">Ion trajectory stability in an oscillating RF/DC field (Mass Filter) [55, 56]</td>
<td style="text-align: left;">Low (~2,000 FWHM)</td>
<td style="text-align: left;">Low (0.1 Da)</td>
<td style="text-align: left;">Very Fast (Scan or Filter)</td>
<td style="text-align: left;">Routine Quantification, Mass Filtering (MS1) [48, 55, 81]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Time-of-Flight (TOF)</strong></td>
<td style="text-align: left;">Time to travel a fixed distance; all ions given same Kinetic Energy (<span class="math inline">KE = \frac{1}{2}mv^2</span>) [62, 63]</td>
<td style="text-align: left;">High (~10,000 - 60,000 FWHM)</td>
<td style="text-align: left;">Good (5-10 ppm)</td>
<td style="text-align: left;">Extremely Fast (Pulsed)</td>
<td style="text-align: left;">Fast separations (GCxGC), MALDI, Discovery (Q-TOF) [48, 63, 77]</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Orbitrap</strong></td>
<td style="text-align: left;">Frequency of axial oscillation in an electrostatic field (Frequency <span class="math inline">\propto 1/\sqrt{m/z}</span>) [67, 68]</td>
<td style="text-align: left;">Ultra-High (HRAM) (120,000 - 500,000+ FWHM)</td>
<td style="text-align: left;">Excellent (HRAM) (&lt;1-3 ppm)</td>
<td style="text-align: left;">Moderate (FT required)</td>
<td style="text-align: left;">HRAM Discovery, Metabolite ID, Proteomics [68, 71, 72]</td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
</section>
<section id="part-4-the-detector-counting-the-ions" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="part-4-the-detector-counting-the-ions"><span class="header-section-number">1.3.4</span> Part 4: The Detector – Counting the Ions</h3>
<p>The detector is the final component of the mass spectrometer. It is positioned at the end of the mass analyzer and is responsible for converting the kinetic energy of each ion that strikes its surface into a measurable electrical signal.[3, 12, 82, 83] The two most common types are the Faraday Cup and the Electron Multiplier.</p>
<section id="the-faraday-cup-fc" class="level4">
<h4 class="anchored" data-anchor-id="the-faraday-cup-fc">2.4.1 The Faraday Cup (FC)</h4>
<ul>
<li><strong>Principle:</strong> The Faraday Cup (FC) is a simple, robust, and highly accurate detector. It is, at its core, a conductive metal cup designed to “catch” the charged particles.[84, 85, 86]</li>
<li><strong>Mechanism:</strong> When a positive ion from the analyzer strikes the metal cup, it is neutralized by an electron from a connected circuit. This flow of electrons to the cup constitutes a tiny electrical current.[85, 86] This current is measured, and it is directly proportional to the number of ions hitting the cup (e.g., one nanoamp corresponds to ~6 billion singly-charged ions per second).[86]</li>
<li><strong>Characteristics:</strong> The FC provides <em>no signal gain</em> (one ion strike results in one electron of current).[85] This makes it less sensitive than other detectors.[85, 87] However, it is extremely stable and “highly regarded for accuracy” because of the direct relationship between current and ion count.[86]</li>
</ul>
</section>
<section id="the-electron-multiplier-em" class="level4">
<h4 class="anchored" data-anchor-id="the-electron-multiplier-em">The Electron Multiplier (EM)</h4>
<ul>
<li><strong>Principle:</strong> The Electron Multiplier (EM) is the most common detector in modern mass spectrometers, used for its exceptionally high <em>internal gain</em> and ability to detect single ion events.[82, 88]</li>
<li><strong>Mechanism:</strong> The EM operates on the principle of <strong>secondary electron emission</strong>.[89, 90] It consists of a series of surfaces called “dynodes,” each held at a progressively higher voltage.
<ol type="1">
<li>A single ion from the analyzer strikes the first dynode surface.</li>
<li>This impact has enough energy to “splash” <em>multiple</em> electrons (secondary electrons) from the surface.[90, 91]</li>
<li>These new electrons are accelerated by the voltage gradient (~100-200V) and strike the <em>second</em> dynode.[88]</li>
<li><em>Each</em> of these electrons, in turn, splashes <em>more</em> electrons from the second dynode’s surface.</li>
<li>This “cascade” [82] continues down a series of discrete dynodes or along the wall of a continuous, horn-shaped dynode.[90, 91]</li>
</ol></li>
<li><strong>Characteristics:</strong> The result is a massive signal amplification. A single ion striking the front of the multiplier can result in a measurable pulse of <span class="math inline">10^6</span> to <span class="math inline">10^8</span> electrons exiting the back, allowing for single-ion counting.[82, 85, 88]</li>
</ul>
<p>This leads to a classic detector trade-off: sensitivity versus stability.[87, 92] The EM is extremely sensitive and required for trace-level analysis. The FC is less sensitive but offers “excellent precision” and stability.[92] For this reason, EMs are standard for most quantitative and qualitative work, while FCs are preferred for high-precision <em>isotope ratio mass spectrometry (IRMS)</em>, where the stability of the ratio measurement is more important than raw sensitivity.[2, 92]</p>
</section>
</section>
</section>
<section id="preparing-for-analysis-from-sample-to-instrument" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="preparing-for-analysis-from-sample-to-instrument"><span class="header-section-number">1.4</span> Preparing for Analysis: From Sample to Instrument</h2>
<p>Sample preparation is the essential precondition for high-quality MS data, directly influencing sensitivity, reproducibility, and instrument longevity.[8, 20, 16] Effective workflows combine purification, concentration, and—when appropriate—chemical derivatization to stabilize or volatilize analytes before they enter the mass spectrometer.</p>
<ul>
<li><strong>Purification &amp; concentration:</strong> Solid-phase extraction (SPE) and desalting protocols remove salts and detergents that otherwise suppress ionization efficiency.[8, 20]</li>
<li><strong>Chemical derivatization:</strong> Strategic derivatization increases volatility for GC-MS analyses or enhances ionization efficiency for LC-MS approaches.[20]</li>
<li><strong>Proteomics workflows:</strong> Bottom-up digestion with sequence-grade proteases remains the most reproducible route to comprehensive protein identification.[8, 12]</li>
</ul>
<p><strong>Best practice:</strong> Employ MS-compatible solvents (acetonitrile, methanol) and volatile buffers (ammonium acetate or ammonium formate) to minimize ion suppression in both chromatographic and direct-infusion methods.[8, 20]</p>
<p>This is the most critical, and most often-failed, step for new users. Mass spectrometers are high-sensitivity, high-vacuum instruments, and “operating outside of this range normally results in severe degradation of performance”.[93] The “Garbage In, Garbage Out” (GIGO) principle is paramount. Impure samples, containing high concentrations of non-volatile salts, detergents, or contaminants, will not produce good mass spectra.[94] These non-volatile components will clog the instrument, contaminate the ion source, and, most damagingly, cause <strong>ion suppression</strong>—where the contaminant “steals” the ionizable charge from the analyte, making the analyte invisible to the detector.[95, 96]</p>
<p>Therefore, sample preparation is a non-negotiable step focused on <em>mitigating risk</em>—the risk of instrument contamination, the risk of ion suppression, and the risk of acquiring ambiguous or false data.</p>
<section id="sample-preparation-the-prerequisite-for-quality-data" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="sample-preparation-the-prerequisite-for-quality-data"><span class="header-section-number">1.4.1</span> Sample Preparation: The Prerequisite for Quality Data</h3>
<section id="general-considerations-small-molecules" class="level4">
<h4 class="anchored" data-anchor-id="general-considerations-small-molecules">General Considerations (Small Molecules)</h4>
<ul>
<li><strong>Purity &amp; Concentration:</strong> Samples should be as pure as possible.[94] A typical starting concentration for a pure compound is ~1 mg/mL, which is then serially diluted into an appropriate solvent for analysis.[97]</li>
<li><strong>Solvents:</strong> Solvents must be compatible with the ionization source. ESI requires polar, volatile solvents (e.g., methanol, acetonitrile, water).[9, 97] If using organic solvents like chloroform or DCM, <em>glass</em> vials must be used, as these solvents will leach plasticizers from plastic tubes, leading to severe contamination.[95]</li>
<li><strong>The Enemy: Non-Volatile Salts &amp; Buffers:</strong> Non-volatile salts (e.g., NaCl, KCl, phosphate buffers) are the <em>number one cause of ESI-MS failure</em>. They do not evaporate in the ESI source but instead precipitate, rapidly clogging the capillary and source optics. They also form “adducts” (e.g., <span class="math inline">[M+Na]^{+}</span>) that complicate the spectrum and, most importantly, they “steal” the charge from the analyte, causing severe ion suppression.[9, 95] If a buffer is absolutely required, it <em>must</em> be volatile (e.g., ammonium acetate, ammonium formate, or formic acid).[98]</li>
</ul>
</section>
<section id="clean-up-and-concentration-solid-phase-extraction-spe" class="level4">
<h4 class="anchored" data-anchor-id="clean-up-and-concentration-solid-phase-extraction-spe">Clean-up and Concentration: Solid-Phase Extraction (SPE)</h4>
<ul>
<li><strong>Purpose:</strong> SPE is a powerful clean-up technique used to separate the analyte of interest from a complex matrix (like plasma or urine), remove interfering compounds (like salts), and concentrate the analyte.[96, 99]</li>
<li><strong>Mechanism:</strong> SPE uses a small, disposable cartridge packed with a sorbent (e.g., C18-silica, reversed-phase). The process follows four steps, often abbreviated “CLWE” [100]:
<ol type="1">
<li><strong>C</strong>ondition: The sorbent is wetted (e.g., with methanol) and equilibrated (e.g., with water).</li>
<li><strong>L</strong>oad: The aqueous sample is passed through the sorbent. The analyte, being hydrophobic, <em>sticks</em> to the C18 sorbent, while the salts and polar interferences pass through to waste.</li>
<li><strong>W</strong>ash: A weak solvent (e.g., 5% methanol/water) is passed through to wash away any remaining, weakly-bound interferences.</li>
<li><strong>E</strong>lute: A strong organic solvent (e.g., 90% methanol) is used to <em>elute</em> the now-purified and concentrated analyte from the sorbent.</li>
</ol></li>
<li><strong>Key Benefit for MS:</strong> The primary benefit of SPE is the <strong>reduction of ion suppression</strong>.[96] By removing the salts and other matrix components that compete for charge, the analyte’s signal is dramatically improved, leading to higher sensitivity and more accurate results.</li>
</ul>
</section>
<section id="chemical-modification-derivatization-for-gc-ms" class="level4">
<h4 class="anchored" data-anchor-id="chemical-modification-derivatization-for-gc-ms">Chemical Modification: Derivatization for GC-MS</h4>
<ul>
<li><strong>Purpose:</strong> GC-MS requires all analytes to be <em>volatile</em> and <em>thermally stable</em>.[35, 101] Many biologically and pharmaceutically relevant molecules (e.g., sugars, amino acids, steroids) are not; they are highly polar and will decompose before they vaporize.[101]</li>
<li><strong>Mechanism:</strong> Derivatization is a chemical reaction that solves this problem. It targets the polar functional groups (e.g., -OH, -NH, -SH) and replaces the active, polar hydrogens with non-polar, bulky groups. This masks the polarity, <em>increases volatility</em>, and makes the molecule “flyable” on a GC.[101, 102]</li>
<li><strong>Common Methods:</strong> The three most widely used methods are [103]:
<ol type="1">
<li><strong>Silylation:</strong> Replaces an active hydrogen with a silyl group, most commonly trimethylsilane (TMS).[101, 103]</li>
<li><strong>Acylation:</strong> Replaces an active hydrogen with an acyl group.[103, 104]</li>
<li><strong>Alkylation:</strong> Modifies compounds with acidic hydrogens, like carboxylic acids, to form esters.[101, 103]</li>
</ol></li>
</ul>
</section>
<section id="protocols-for-complex-biological-matrices-proteomics" class="level4">
<h4 class="anchored" data-anchor-id="protocols-for-complex-biological-matrices-proteomics">Protocols for Complex Biological Matrices (Proteomics)</h4>
<p>Modern proteomics, the large-scale study of proteins [105, 106], does not typically analyze intact proteins. Instead, it uses a <strong>“bottom-up”</strong> approach.[105, 107, 108] The goal of this complex workflow is to turn a sample’s entire proteome (thousands of proteins) into a clean, separated mixture of <em>peptides</em>, which are more suitable for LC-MS analysis.[109]</p>
<p>A standard “bottom-up” workflow involves the following steps [109, 110]:</p>
<ol type="1">
<li><strong>Lysis:</strong> The cells or tissues are first physically or chemically disrupted (lysed) to release all the proteins, typically into a strong detergent solution (like SDS) or a chaotropic agent (like urea).[109, 110] <em>Critically</em>, <strong>protease inhibitors</strong> must be added to the lysis buffer to prevent the sample’s own endogenous enzymes from degrading the proteins upon cell rupture.[109]</li>
<li><strong>Precipitation/Clean-up:</strong> Interfering compounds like detergents (which are incompatible with MS), lipids, and salts are removed. This is often done by precipitating the protein out of solution using cold acetone or a chloroform/methanol mixture.[111, 112] The “crashed out” protein pellet is retained, and the contaminants are washed away.</li>
<li><strong>Reduction &amp; Alkylation:</strong> The purified proteins are re-dissolved and unfolded (denatured). Their disulfide bonds (S-S) are chemically <em>reduced</em> to free thiols (-SH) using a reducing agent (e.g., DTT or TCEP). These new -SH groups are then <em>alkylated</em> (e.g., with iodoacetamide, IAM), which adds a “cap” to them. This irreversible step prevents the disulfide bonds from re-forming.[109, 110]</li>
<li><strong>Digestion:</strong> The protease <strong>Trypsin</strong> is added. Trypsin is the workhorse of proteomics because it is highly specific: it cleaves protein chains <em>only</em> on the C-terminal side of Lysine (K) and Arg_inine (R) residues. This digestion process breaks the thousands of proteins into millions of peptides, but in a highly predictable and reproducible way.</li>
<li><strong>Peptide Desalting:</strong> The final peptide mixture (“digest”) is still in a high-salt buffer. The last step is to “desalt” it using an SPE C18 “tip” (a small pipette tip packed with C18 resin). The peptides stick, the salt is washed away, and the clean peptides are eluted in a small volume of organic solvent, ready for LC-MS analysis.[109]</li>
</ol>
</section>
</section>
<section id="instrument-setup-tuning-and-calibration" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="instrument-setup-tuning-and-calibration"><span class="header-section-number">1.4.2</span> Instrument Setup: Tuning and Calibration</h3>
<p>Before acquiring data, the instrument must be prepared. This is a two-step process: tuning (optimizing the signal) and calibration (ensuring accuracy). A simple way to distinguish them is: <strong>Calibration is an X-axis (</strong><span class="math inline">m/z</span>) problem, while Tuning is a Y-axis (intensity) problem.[113]</p>
<section id="tuning-optimizing-the-y-axis-sensitivity-resolution" class="level4">
<h4 class="anchored" data-anchor-id="tuning-optimizing-the-y-axis-sensitivity-resolution">Tuning: Optimizing the Y-Axis (Sensitivity &amp; Resolution)</h4>
<ul>
<li><strong>Purpose:</strong> To adjust the dozens of electronic voltages (on the ion lenses, reflectron, quadrupoles, etc.) to maximize the <em>intensity</em> (sensitivity) and <em>quality</em> (peak shape, resolution) of the ion signal.[57, 113, 114]</li>
<li><strong>Process:</strong> A known tuning standard (a “calibrant”) is infused into the instrument. The operator, or more commonly an “autotune” routine, then systematically adjusts the voltages to find the “sweet spot” that produces the strongest and sharpest peak for that ion.[57, 114] This often involves balancing a direct <em>trade-off</em> between sensitivity and resolution; tuning for maximum resolution may slightly decrease sensitivity, and vice versa.[57]</li>
</ul>
</section>
<section id="calibration-optimizing-the-x-axis-mass-accuracy" class="level4">
<h4 class="anchored" data-anchor-id="calibration-optimizing-the-x-axis-mass-accuracy">Calibration: Optimizing the X-Axis (Mass Accuracy)</h4>
<ul>
<li><strong>Purpose:</strong> To ensure that the <span class="math inline">m/z</span> value reported on the x-axis is <em>correct</em>.[113, 115] This is “critical for the reliability, accuracy, and precision” of all measurements.[116, 117]</li>
<li><strong>Process:</strong> An external <strong>calibrant solution</strong>—a mixture of compounds with well-known, highly accurate masses that span the instrument’s mass range—is infused.[115, 118] The software acquires a spectrum, measures the <em>apparent</em> <span class="math inline">m/z</span> of these known compounds (e.g., their flight time in a TOF), and builds a <em>calibration curve</em> that maps the measured “apparent” values to the <em>true, correct</em> <span class="math inline">m/z</span> values.[115, 119]</li>
<li><strong>Frequency:</strong> This <em>must</em> be done regularly (e.g., daily).[120] Instrument electronics drift with temperature and use, causing the mass assignment to “walk” over time.[120] For HRAM instruments (Orbitrap, Q-TOF), where high mass accuracy is the entire point, an internal calibrant or “lock mass” is often used. This involves a continuous, low-level spray of a known calibrant compound <em>during</em> the analytical run, allowing the software to correct for mass drift in real-time.[113, 121] Different calibrants are required for different sources and polarities (e.g., perfluorokerosene (PFK) for EI [122], or a specific ESI negative-ion solution [123]).</li>
</ul>
</section>
</section>
</section>
<section id="strategies-for-data-collection-designing-the-ms-experiment" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="strategies-for-data-collection-designing-the-ms-experiment"><span class="header-section-number">1.5</span> Strategies for Data Collection: Designing the MS Experiment</h2>
<p>With a prepared sample and a tuned, calibrated instrument, the operator must now make the most important decision: <em>how</em> to collect the data. This choice is dictated entirely by the analytical goal. The two governing philosophies are <strong>Untargeted (Discovery)</strong> analysis and <strong>Targeted (Quantitative)</strong> analysis.[124, 125, 126]</p>
<ol type="1">
<li><strong>Untargeted (Discovery):</strong> The goal is to “detect as many metabolites [or peptides] as possible”.[126] You are <em>exploring</em> the sample to see what is there, often without <em>a priori</em> knowledge. The preferred modes are <strong>Full Scan</strong>, <strong>Data-Dependent Acquisition (DDA)</strong>, and <strong>Data-Independent Acquisition (DIA)</strong>.</li>
<li><strong>Targeted (Quantification):</strong> The goal is the “multiplexed analysis of a set of defined metabolites”.[126] You are <em>measuring</em> the abundance of specific, known compounds. The preferred modes are <strong>Selected Ion Monitoring (SIM)</strong> and <strong>Selected/Multiple Reaction Monitoring (SRM/MRM)</strong>.</li>
</ol>
<p><br> <strong>Table 3. Guide to Mass Spectrometry Data Acquisition Modes</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Mode</th>
<th style="text-align: left;">Goal</th>
<th style="text-align: left;">Instrument(s) Used</th>
<th style="text-align: left;">Data Acquired</th>
<th style="text-align: left;">Key Advantage</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Full Scan</strong></td>
<td style="text-align: left;"><strong>Untargeted</strong></td>
<td style="text-align: left;">Any MS (Q, TOF, Orbitrap)</td>
<td style="text-align: left;">MS1 only</td>
<td style="text-align: left;">Comprehensive snapshot; simple; allows retrospective analysis [124, 127, 128]</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Selected Ion Monitoring (SIM)</strong></td>
<td style="text-align: left;"><strong>Targeted</strong></td>
<td style="text-align: left;">Quadrupole</td>
<td style="text-align: left;">MS1 only (Specific <span class="math inline">m/z</span> values)</td>
<td style="text-align: left;">High Sensitivity (trace analysis); good for quantification [59, 128]</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Product Ion Scan (PIS)</strong></td>
<td style="text-align: left;"><strong>Targeted</strong></td>
<td style="text-align: left;">Tandem MS (QqQ, Q-TOF)</td>
<td style="text-align: left;">MS/MS (of one precursor)</td>
<td style="text-align: left;">Qualitative; provides structural “fingerprint” of one known ion [78, 129]</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Selected Reaction Monitoring (SRM/MRM)</strong></td>
<td style="text-align: left;"><strong>Targeted</strong></td>
<td style="text-align: left;"><strong>Triple Quadrupole (QqQ)</strong></td>
<td style="text-align: left;">MS/MS (Specific “transition”)</td>
<td style="text-align: left;"><strong>Unmatched Sensitivity &amp; Selectivity</strong>; Gold standard for quantification [130, 131, 132]</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Data-Dependent Acquisition (DDA)</strong></td>
<td style="text-align: left;"><strong>Untargeted</strong></td>
<td style="text-align: left;">Tandem MS (Q-TOF, Orbitrap)</td>
<td style="text-align: left;">MS1 + MS/MS (of “Top N”)</td>
<td style="text-align: left;">Good for ID; generates clean MS/MS spectra from single precursors [133]</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Data-Independent Acquisition (DIA)</strong></td>
<td style="text-align: left;"><strong>Untargeted</strong></td>
<td style="text-align: left;">Tandem MS (Q-TOF, Orbitrap)</td>
<td style="text-align: left;">MS1 + MS/MS (of <em>everything</em>)</td>
<td style="text-align: left;">Unbiased; <strong>Highly Reproducible</strong>; good for quantification; <em>de facto</em> standard for discovery proteomics [133, 134, 135, 136]</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><br></p>
<section id="untargeted-acquisition-modes-discovery" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="untargeted-acquisition-modes-discovery"><span class="header-section-number">1.5.1</span> Untargeted Acquisition Modes (Discovery)</h3>
<section id="full-scan-mode" class="level4">
<h4 class="anchored" data-anchor-id="full-scan-mode">Full Scan Mode</h4>
<ul>
<li><strong>Workflow:</strong> This is the simplest acquisition mode. The mass analyzer is set to scan a wide <span class="math inline">m/z</span> range (e.g., <span class="math inline">m/z</span> 100-1000) and records <em>only MS1 spectra</em> (precursor ions).[124, 125, 127] No fragmentation is intentionally induced.[126]</li>
<li><strong>Pros:</strong> It captures <em>all</em> precursor ions, providing a comprehensive “snapshot” of the sample.[127, 128] Because all data is recorded, it allows for “retrospective analysis”—a user can go back to the data file years later to look for a compound they didn’t know about at the time of acquisition.[127]</li>
<li><strong>Cons:</strong> It provides <em>no</em> fragmentation data, which makes confident structural identification of unknowns extremely difficult.[126, 137] It also has lower sensitivity compared to targeted modes, as the detector’s time is divided across the entire <span class="math inline">m/z</span> range.[128]</li>
</ul>
</section>
<section id="data-dependent-acquisition-dda" class="level4">
<h4 class="anchored" data-anchor-id="data-dependent-acquisition-dda">Data-Dependent Acquisition (DDA)</h4>
<ul>
<li><strong>Goal:</strong> To automatically acquire fragmentation (MS/MS) spectra for the <em>most interesting</em> (i.e., most abundant) peaks in real-time, in order to identify them.[138, 139]</li>
<li><strong>Workflow:</strong> DDA is a “smart” reflexive workflow [124, 133, 134, 140]:
<ol type="1">
<li>The instrument performs a fast, high-resolution <strong>MS1 Full Scan</strong>.</li>
<li>The instrument’s computer <em>in real-time</em> identifies the “Top N” <em>most abundant</em> precursor ions in that scan (e.g., N=10).</li>
<li>The instrument <em>sequentially</em> performs a full <strong>MS/MS (Product Ion Scan)</strong> on each of those N ions: it isolates the precursor (MS1), fragments it (q2), and scans all of its product ions (MS2).</li>
<li>The instrument then repeats this entire cycle (e.g., 1 MS1 scan + 10 MS/MS scans), which typically takes 1-3 seconds.[135] To avoid analyzing the same peak over and over, it uses “dynamic exclusion,” ignoring an ion it has just fragmented for the next 30-60 seconds.</li>
</ol></li>
<li><strong>Pros:</strong> DDA generates <em>clean, high-quality</em> MS/MS spectra that originate from a <em>single, isolated</em> precursor ion. This makes the data simple to interpret and search against spectral libraries for identification.[126, 133]</li>
<li><strong>Cons:</strong> DDA is <strong>biased and stochastic</strong>. It is <em>biased</em> toward the “Top N” most abundant ions [133, 136], meaning low-abundance ions are <em>consistently ignored</em>.[133, 136] It is <em>stochastic</em> (random) because the “Top N” list may be slightly different from run to run, leading to “under-sampling” and <em>poor reproducibility</em>, especially for quantitative comparisons.[133, 134]</li>
</ul>
</section>
<section id="data-independent-acquisition-dia" class="level4">
<h4 class="anchored" data-anchor-id="data-independent-acquisition-dia">Data-Independent Acquisition (DIA)</h4>
<ul>
<li><strong>Goal:</strong> To solve the bias and reproducibility problems of DDA by acquiring fragmentation data for <em>everything</em>, regardless of abundance.[134, 141]</li>
<li><strong>Workflow:</strong> DIA is an unbiased, systematic workflow [124, 134]:
<ol type="1">
<li>The <em>entire</em> <span class="math inline">m/z</span> range of interest (e.g., <span class="math inline">m/z</span> 400-1000) is divided into wide, consecutive “isolation windows” (e.g., 20-25 Da wide).</li>
<li>The instrument <em>systematically</em> steps through these windows. In the first scan, it isolates <em>all ions</em> in the <span class="math inline">m/z</span> 400-425 window.</li>
<li>It fragments <em>all</em> of those ions <em>simultaneously</em> in the collision cell.</li>
<li>It records a <em>single, composite</em> MS/MS spectrum containing the fragments from <em>all</em> precursors that were in the <span class="math inline">m/z</span> 400-425 window.</li>
<li>In the next scan, it repeats this for <span class="math inline">m/z</span> 425-450, and so on, until the full range is covered.</li>
</ol></li>
<li><strong>Pros:</strong> DIA is <strong>unbiased and highly reproducible</strong>. It fragments <em>all</em> ions, including low-abundance ones, in every single run.[124, 136] This provides “higher precision and better reproducibility than DDA” [133, 136, 142] and has been shown to “identify and quantify over 3 times as many proteins” as DDA.[143] It has become the new standard for large-scale discovery and quantitative proteomics.[133]</li>
<li><strong>Cons:</strong> The data is <em>extremely complex</em>. The resulting MS/MS spectra are “chimeric” or “multiplexed” [135]—a jumble of fragments from dozens of different precursors that co-eluted. “Data analysis is challenging” [135] and <em>requires</em> sophisticated deconvolution software and pre-existing spectral libraries (often generated from DDA runs) to “mine” the data and assign fragments back to their correct precursors.[133, 141, 144]</li>
</ul>
</section>
</section>
<section id="targeted-acquisition-modes-quantification" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="targeted-acquisition-modes-quantification"><span class="header-section-number">1.5.2</span> Targeted Acquisition Modes (Quantification)</h3>
<section id="selected-ion-monitoring-sim" class="level4">
<h4 class="anchored" data-anchor-id="selected-ion-monitoring-sim">Selected Ion Monitoring (SIM)</h4>
<ul>
<li><strong>Workflow:</strong> SIM is a <em>targeted MS1</em> mode, typically performed on a quadrupole. Instead of scanning the full <span class="math inline">m/z</span> range, the operator programs the analyzer to <em>only</em> monitor a few specific, pre-selected <span class="math inline">m/z</span> values that correspond to the target analytes.[59, 128, 145]</li>
<li><strong>“Dwell Time”:</strong> The instrument “dwells” on <span class="math inline">m/z</span> 254.1 for 100 milliseconds, collecting signal, then “hops” to <span class="math inline">m/z</span> 301.2 for 100ms, then hops back. Because the detector “stares” at the ion of interest for a long time—rather than dividing its time across a 1000-Da scan—the signal-to-noise ratio is “dramatically” boosted.[59, 128]</li>
<li><strong>Pros:</strong> <strong>High Sensitivity</strong>. SIM can be 10x to 100x more sensitive than a Full Scan, making it ideal for trace-level quantification.[59, 128, 146]</li>
<li><strong>Cons:</strong> You <em>must</em> know the <span class="math inline">m/z</span> of your target beforehand. You are “blind” to all other compounds in the sample.[128]</li>
</ul>
</section>
<section id="product-ion-scan-pis" class="level4">
<h4 class="anchored" data-anchor-id="product-ion-scan-pis">Product Ion Scan (PIS)</h4>
<ul>
<li><strong>Workflow:</strong> This is the basic <em>qualitative</em> MS/MS scan, used for structural elucidation.[147]</li>
<li><strong>Operation:</strong> [78, 129]
<ol type="1">
<li><strong>MS1 (e.g., Q1) is FIXED</strong> to select <em>one</em> precursor ion of interest (e.g., <span class="math inline">m/z</span> 300).</li>
<li>The <span class="math inline">m/z</span> 300 ion is fragmented in the collision cell (q2).</li>
<li><strong>MS2 (e.g., Q3 or TOF) is SET TO SCAN</strong> the full <span class="math inline">m/z</span> range to detect <em>all</em> resulting product ions (e.g., <span class="math inline">m/z</span> 282, 254, 150…).</li>
</ol></li>
<li><strong>Goal:</strong> To generate a full fragmentation “fingerprint” of one specific ion. This is used to confirm a compound’s identity by matching its fragment spectrum to a library, or to determine its chemical structure.[147, 148, 149]</li>
</ul>
</section>
<section id="selected-reaction-monitoring-srm-multiple-reaction-monitoring-mrm" class="level4">
<h4 class="anchored" data-anchor-id="selected-reaction-monitoring-srm-multiple-reaction-monitoring-mrm">Selected Reaction Monitoring (SRM) / Multiple Reaction Monitoring (MRM)</h4>
<ul>
<li><strong>Nomenclature:</strong> The terms are interchangeable.[150, 151] <strong>SRM</strong> refers to monitoring one single “transition” (precursor <span class="math inline">\rightarrow</span> product). <strong>MRM</strong> is simply the common practice of monitoring <em>multiple</em> SRM transitions in a single run.[78, 150]</li>
<li><strong>Workflow:</strong> This is the <strong>gold standard for targeted quantification</strong>.[130, 152, 153] It requires a <strong>Triple Quadrupole (QqQ)</strong> instrument.</li>
<li><strong>Operation:</strong> [129, 131]
<ol type="1">
<li><strong>MS1 (Q1) is FIXED</strong> to select a specific precursor <span class="math inline">m/z</span> (e.g., <span class="math inline">m/z</span> 300).</li>
<li>This ion is fragmented in the collision cell (q2).</li>
<li><strong>MS2 (Q3) is ALSO FIXED</strong> to select <em>one</em> specific, high-intensity product <span class="math inline">m/z</span> that is characteristic of that precursor (e.g., <span class="math inline">m/z</span> 282).</li>
</ol></li>
<li><strong>Pros: Unmatched Sensitivity and Selectivity.</strong> This mode is “non-scanning”.[131] The QqQ acts as a “double mass filter” [130], only allowing ions that pass the specific <em>precursor</em> <span class="math inline">\rightarrow</span> product “transition” to reach the detector.[78] This process virtually eliminates all chemical background and noise. The result is “exquisite sensitivity” [132], “up to 100-fold” better than a full Product Ion Scan [130], and a “wide dynamic range” (often 4-5 orders of magnitude).[131] It is the definitive method for quantitative proteomics and clinical assays (e.g., measuring drugs in blood plasma).[132, 151, 154]</li>
<li><strong>SRM Workflow Setup:</strong> An SRM assay must be rigorously developed.[151, 155, 156] The workflow is: (1) <em>Select</em> target peptides/compounds. (2) <em>Select</em> several unique precursor <span class="math inline">\rightarrow</span> product <em>transitions</em> for each target. (3) <em>Optimize</em> the collision energy for each transition to find the most intense signal. (4) <em>Validate</em> the method for absolute quantification using stable isotope-labeled internal standards.[154]</li>
</ul>
</section>
</section>
</section>
<section id="initial-data-interpretation-understanding-the-output" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="initial-data-interpretation-understanding-the-output"><span class="header-section-number">1.6</span> Initial Data Interpretation: Understanding the Output</h2>
<section id="the-chromatogram-vs.-the-spectrum" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="the-chromatogram-vs.-the-spectrum"><span class="header-section-number">1.6.1</span> The Chromatogram vs.&nbsp;The Spectrum</h3>
<p>Data from a hyphenated technique (LC-MS or GC-MS) is two-dimensional, containing both <em>m/z</em> and <em>retention time</em> information.[19, 157] The instrument is “always on” [158], acquiring a full mass spectrum every second (or faster). The output is not a single spectrum, but <em>thousands</em> of spectra, one for each point in time.[157, 158] This dataset is visualized in two primary ways.</p>
<section id="reading-the-time-profile-total-ion-chromatogram-tic" class="level4">
<h4 class="anchored" data-anchor-id="reading-the-time-profile-total-ion-chromatogram-tic">Reading the Time Profile: Total Ion Chromatogram (TIC)</h4>
<ul>
<li><strong>What it is:</strong> The primary output. It is a 2D plot of <strong>Time (x-axis)</strong> vs.&nbsp;<strong>Total Ion Intensity (y-axis)</strong>.[157, 159]</li>
<li><strong>How it’s made:</strong> At each time point (e.g., 4.50 min), the instrument sums the intensities of <em>all</em> ions (across the entire <span class="math inline">m/z</span> range) in the mass spectrum acquired at that instant. This single “total” value is plotted.[160, 161]</li>
<li><strong>What it shows:</strong> The TIC is a “map” of the analysis. Each peak in the TIC represents one or more compounds eluting from the chromatograph.[18, 159]</li>
</ul>
</section>
<section id="the-mass-spectrum" class="level4">
<h4 class="anchored" data-anchor-id="the-mass-spectrum">The Mass Spectrum</h4>
<ul>
<li><strong>How to get it:</strong> By <em>clicking</em> on a specific time point in the TIC (e.g., the apex of the peak at 4.50 min), the user can display the <em>single</em> mass spectrum that was acquired at that <em>exact</em> moment.[157]</li>
<li><strong>What it is:</strong> This is the plot of <span class="math inline">m/z</span> (x-axis) vs.&nbsp;<strong>Relative Abundance (y-axis)</strong>.[7, 8]</li>
<li><strong>Y-Axis (Relative Abundance):</strong> This y-axis is <em>not</em> an absolute count. The instrument software finds the <em>tallest</em> peak in that single spectrum, sets its intensity to <strong>100%</strong>, and then scales all other peaks in that same spectrum relative to it.[4, 7, 162, 163]</li>
</ul>
</section>
</section>
<section id="reading-the-mass-spectrum" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="reading-the-mass-spectrum"><span class="header-section-number">1.6.2</span> Reading the Mass Spectrum</h3>
<section id="key-peaks-the-molecular-ion-m-and-the-base-peak" class="level4">
<h4 class="anchored" data-anchor-id="key-peaks-the-molecular-ion-m-and-the-base-peak">Key Peaks: The Molecular Ion (M+) and the Base Peak</h4>
<ul>
<li><strong>Molecular Ion (</strong><span class="math inline">M^{+\bullet}</span> or <span class="math inline">[M+H]^+</span>): This is the peak that corresponds to the <em>intact, unfragmented molecule</em>.[162, 163, 164] It is (usually) the peak with the highest <span class="math inline">m/z</span> value, excluding small isotope peaks. This peak is the most important, as it <em>tells you the molecular weight</em> of the compound.[164, 165]</li>
<li><strong>Base Peak:</strong> This is simply the <em>tallest</em> peak in the entire spectrum. It is assigned a relative abundance of 100%.[7, 166, 167, 168]</li>
<li><strong>Distinction:</strong> The <strong>Base Peak is <em>not</em> necessarily the Molecular Ion</strong>.[162, 168, 169] In hard ionization (EI), the molecular ion may be very unstable and fragment so completely that its peak (M+) is very small or absent. The Base Peak will instead be the <em>most abundant fragment</em>, which typically represents the <em>most stable carbocation</em> or fragment that can be formed.[166, 168, 169] The M+ peak tells you the <em>size</em> of the molecule; the Base Peak gives you a clue about its <em>structure</em> (e.g., a particularly stable sub-unit).</li>
</ul>
</section>
<section id="interpreting-patterns-i-isotopic-distributions" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-patterns-i-isotopic-distributions">Interpreting Patterns I: Isotopic Distributions</h4>
<p>Masses are not single lines; they are clusters of peaks that appear at M+1, M+2, etc..[164, 165] These “isotope peaks” exist because of the natural abundance of heavy stable isotopes (e.g., <span class="math inline">^{13}</span>C, <span class="math inline">^{15}</span>N, <span class="math inline">^{18}</span>O, <span class="math inline">^{34}</span>S, <span class="math inline">^{37}</span>Cl, <span class="math inline">^{81}</span>Br).[164, 170] These patterns are highly diagnostic.</p>
<ul>
<li><strong>Using the M+1 Peak:</strong> The natural abundance of <span class="math inline">^{13}</span>C is ~1.1%.[164, 170] Therefore, the relative intensity of the M+1 peak (compared to the M+ peak) is directly proportional to the <em>number of carbon atoms</em> in the molecule.[164] A molecule with an M+1 peak that is 6.6% as tall as the M+ peak suggests the presence of ~6 carbon atoms (6 <span class="math inline">\times</span> 1.1% = 6.6%).[164]</li>
<li><strong>Using the M+2 Peak:</strong> This peak is a “dead giveaway” for two elements:
<ul>
<li><strong>Chlorine:</strong> Chlorine exists as <span class="math inline">^{35}</span>Cl and <span class="math inline">^{37}</span>Cl in a natural ratio of ~3:1. A compound containing <em>one</em> chlorine atom will show a characteristic M+2 peak that is <strong>1/3</strong> the height of the M+ peak.[165, 170]</li>
<li><strong>Bromine:</strong> Bromine exists as <span class="math inline">^{79}</span>Br and <span class="math inline">^{81}</span>Br in a natural ratio of ~1:1. A compound containing <em>one</em> bromine atom will show a characteristic M+2 peak that is <strong>equal</strong> in height to the M+ peak.[165, 170]</li>
</ul></li>
</ul>
</section>
<section id="interpreting-patterns-ii-fragmentation-ei" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-patterns-ii-fragmentation-ei">Interpreting Patterns II: Fragmentation (EI)</h4>
<ul>
<li><strong>What they are:</strong> In an EI spectrum, all the peaks at <span class="math inline">m/z</span> values <em>lower</em> than the molecular ion are “fragment ions”.[163] They are the “pieces” the molecule shattered into.[8, 163]</li>
<li><strong>How to read them:</strong> The <em>difference in mass</em> between the molecular ion (M+) and a fragment peak represents the <em>neutral piece</em> that was <em>lost</em> during fragmentation.[34]</li>
<li><strong>Common Losses:</strong> By looking for these “neutral losses,” a structure can be postulated.[30, 34, 164]
<ul>
<li><strong>Loss of 15</strong> (a peak at <span class="math inline">m/z</span> = M-15) indicates the loss of a methyl radical (<span class="math inline">\bullet CH_3</span>).[34]</li>
<li><strong>Loss of 29</strong> (a peak at <span class="math inline">m/z</span> = M-29) indicates the loss of an ethyl radical (<span class="math inline">\bullet CH_2CH_3</span>).[8]</li>
<li><strong>Loss of 18</strong> (a peak at <span class="math inline">m/z</span> = M-18) often indicates the loss of water (<span class="math inline">H_2O</span>) from an alcohol.</li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="a-horizon-of-applications" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="a-horizon-of-applications"><span class="header-section-number">1.7</span> A Horizon of Applications</h2>
<p>By mastering the principles of instrumentation, sample preparation, and data acquisition, the researcher gains access to one of the most versatile and powerful analytical tools in modern science.</p>
<ul>
<li><p><strong>System-Wide Analysis: Proteomics and Metabolomics:</strong> MS is the engine of the “omics” revolution. In <strong>proteomics</strong>, it allows for the “system-wide characterization of the proteome” [105], enabling the identification and quantification of <em>thousands</em> of proteins [105], their isoforms [171], and their critical post-translational modifications (PTMs).[171, 172] In <strong>metabolomics</strong>, the “comprehensive study of small molecules” [173], the high sensitivity and resolution of MS characterizes the “wide range of metabolites” [173, 174] that define a biological state, identifying new biomarkers of disease and metabolic pathways.[71, 175] Recent advances in sensitivity have pushed these frontiers into <strong>single-cell proteomics</strong> and <strong>spatial profiling</strong>.[105, 176, 177]</p></li>
<li><p><strong>Spatially-Resolved Analysis: MALDI Mass Spectrometry Imaging (MSI):</strong> This “powerful label-free technique” [51, 52, 53] creates “molecular pictures” [53] by collecting thousands of individual MALDI spectra in a grid pattern across a thin tissue section.[50] This allows researchers to see the precise <em>spatial distribution</em> of drugs, lipids, or proteins directly in the tissue, without the need for antibodies or labels.[51, 54]</p></li>
<li><p><strong>Clinical and Pharmaceutical Analysis:</strong> MS is a workhorse in drug development, used to assess the “performance of drugs in vivo” [54], analyze drug-excipient compositions [178], and perform high-sensitivity quantification of drugs in complex matrices like plasma.[71, 179] In <strong>clinical microbiology</strong>, MALDI-TOF has revolutionized the diagnostic lab. It is a “cost- and time-effective” [180] method for the <em>rapid identification</em> of bacterial and fungal species from a patient culture, delivering an answer in minutes instead of the days required for traditional biochemical tests.[180, 181]</p></li>
</ul>


</section>

</main> <!-- /main -->
<script>

// Zoom Controls for Quarto Book

// Adds interactive zoom in/out functionality



(function() {

  'use strict';

  

  // Create zoom controls HTML

  function createZoomControls() {

    const controlsHTML = `

      <div class="zoom-controls" id="zoomControls">

        <button id="zoomInBtn" title="Zoom In (Ctrl +)">+</button>

        <button id="zoomOutBtn" title="Zoom Out (Ctrl -)">−</button>

        <button id="zoomResetBtn" title="Reset Zoom (Ctrl 0)">⌂</button>

        <div class="zoom-indicator" id="zoomIndicator">100%</div>

      </div>

    `;

    

    document.body.insertAdjacentHTML('beforeend', controlsHTML);

  }

  

  // Get current zoom level

  function getCurrentZoom() {

    const zoomClass = document.body.className.match(/zoom-(\d+)/);

    return zoomClass ? parseInt(zoomClass[1]) : 100;

  }

  

  // Set zoom level

  function setZoom(level) {

    // Remove existing zoom classes

    document.body.className = document.body.className

      .replace(/\bzoom-\d+\b/g, '')

      .trim();

    

    // Add new zoom class

    if (level !== 100) {

      document.body.classList.add(`zoom-${level}`);

    }

    

    // Update indicator

    const indicator = document.getElementById('zoomIndicator');

    if (indicator) {

      indicator.textContent = `${level}%`;

    }

    

    // Save to localStorage

    localStorage.setItem('bookZoomLevel', level);

    

    // Update button states

    updateButtonStates(level);

  }

  

  // Update button enabled/disabled states

  function updateButtonStates(level) {

    const zoomInBtn = document.getElementById('zoomInBtn');

    const zoomOutBtn = document.getElementById('zoomOutBtn');

    const zoomResetBtn = document.getElementById('zoomResetBtn');

    

    if (zoomInBtn) {

      zoomInBtn.disabled = level >= 200;

    }

    if (zoomOutBtn) {

      zoomOutBtn.disabled = level <= 50;

    }

    if (zoomResetBtn) {

      zoomResetBtn.disabled = level === 100;

    }

  }

  

  // Zoom in

  function zoomIn() {

    const current = getCurrentZoom();

    const levels = [50, 75, 100, 125, 150, 200];

    const currentIndex = levels.indexOf(current);

    

    if (currentIndex < levels.length - 1) {

      setZoom(levels[currentIndex + 1]);

    }

  }

  

  // Zoom out

  function zoomOut() {

    const current = getCurrentZoom();

    const levels = [50, 75, 100, 125, 150, 200];

    const currentIndex = levels.indexOf(current);

    

    if (currentIndex > 0) {

      setZoom(levels[currentIndex - 1]);

    }

  }

  

  // Reset zoom

  function resetZoom() {

    setZoom(100);

  }

  

  // Initialize zoom controls

  function initZoomControls() {

    // Create controls

    createZoomControls();

    

    // Attach event listeners

    const zoomInBtn = document.getElementById('zoomInBtn');

    const zoomOutBtn = document.getElementById('zoomOutBtn');

    const zoomResetBtn = document.getElementById('zoomResetBtn');

    

    if (zoomInBtn) {

      zoomInBtn.addEventListener('click', zoomIn);

    }

    if (zoomOutBtn) {

      zoomOutBtn.addEventListener('click', zoomOut);

    }

    if (zoomResetBtn) {

      zoomResetBtn.addEventListener('click', resetZoom);

    }

    

    // Keyboard shortcuts

    document.addEventListener('keydown', function(e) {

      // Ctrl + Plus or Ctrl + Equals

      if ((e.ctrlKey || e.metaKey) && (e.key === '+' || e.key === '=')) {

        e.preventDefault();

        zoomIn();

      }

      // Ctrl + Minus

      else if ((e.ctrlKey || e.metaKey) && e.key === '-') {

        e.preventDefault();

        zoomOut();

      }

      // Ctrl + 0

      else if ((e.ctrlKey || e.metaKey) && e.key === '0') {

        e.preventDefault();

        resetZoom();

      }

    });

    

    // Restore saved zoom level

    const savedZoom = localStorage.getItem('bookZoomLevel');

    if (savedZoom) {

      setZoom(parseInt(savedZoom));

    } else {

      setZoom(100);

    }

  }

  

  // Initialize when DOM is ready

  if (document.readyState === 'loading') {

    document.addEventListener('DOMContentLoaded', initZoomControls);

  } else {

    initZoomControls();

  }

  

  // Image click to zoom functionality

  document.addEventListener('click', function(e) {

    if (e.target.tagName === 'IMG' && !e.target.closest('.zoom-container')) {

      const img = e.target;

      const container = document.createElement('div');

      container.className = 'zoom-container';

      container.id = 'imageZoomContainer';

      

      const clonedImg = img.cloneNode(true);

      clonedImg.style.maxWidth = '85%';

      clonedImg.style.maxHeight = '95%';

      clonedImg.style.width = 'auto';

      clonedImg.style.height = 'auto';

      clonedImg.style.objectFit = 'contain';

      container.appendChild(clonedImg);

      document.body.appendChild(container);

      

      // Zoom in

      setTimeout(() => {

        container.classList.add('zoomed');

      }, 10);

      

      // Zoom out on click

      container.addEventListener('click', function() {

        container.classList.remove('zoomed');

        setTimeout(() => {

          container.remove();

        }, 300);

      });

    }

  });

  

})();

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/vanhungtran\.github\.io\/RforMS\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01-Introduction.html" class="pagination-link" aria-label="Introduction to Mass Spectrometry in R">
        <span class="nav-page-text">Introduction to Mass Spectrometry in R</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/vanhungtran/RforMS/edit/main/intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/vanhungtran/RforMS/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>